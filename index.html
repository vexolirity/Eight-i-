<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ PORTAL SUPER KELAS 8I - SMPN 7 Kotabumi Selatan</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Montserrat:wght@800;900&display=swap" rel="stylesheet">
    
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
    /* ========== SUPER COMPLETE CSS (150KB) ========== */
    
    /* 1. VARIABEL UTAMA */
    :root {
        /* Warna Primer */
        --primary: #4361ee;
        --primary-dark: #3a0ca3;
        --primary-light: #4cc9f0;
        --secondary: #7209b7;
        --accent: #f72585;
        --success: #10b981;
        --warning: #f59e0b;
        --danger: #ef4444;
        --info: #06b6d4;
        --dark: #0f172a;
        --darker: #020617;
        --light: #f8fafc;
        
        /* Gradien */
        --gradient-primary: linear-gradient(135deg, #4361ee 0%, #3a0ca3 50%, #7209b7 100%);
        --gradient-accent: linear-gradient(135deg, #f72585 0%, #b5179e 50%, #7209b7 100%);
        --gradient-success: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%);
        
        /* Shadow */
        --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
        --shadow: 0 4px 6px rgba(0,0,0,0.1);
        --shadow-md: 0 10px 15px rgba(0,0,0,0.1);
        --shadow-lg: 0 20px 25px rgba(0,0,0,0.15);
        --shadow-xl: 0 25px 50px rgba(0,0,0,0.25);
        
        /* Border Radius */
        --radius-sm: 4px;
        --radius: 8px;
        --radius-md: 12px;
        --radius-lg: 16px;
        --radius-xl: 20px;
        --radius-full: 9999px;
        
        /* Transisi */
        --transition: all 0.3s ease;
        --transition-slow: all 0.5s ease;
        --transition-bounce: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        
        /* Z-index */
        --z-dropdown: 10;
        --z-sticky: 100;
        --z-modal: 1000;
        --z-popover: 1010;
        --z-tooltip: 1020;
    }
    
    /* 2. RESET & BASE STYLES */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    
    html {
        scroll-behavior: smooth;
        scroll-padding-top: 80px;
    }
    
    body {
        font-family: 'Poppins', sans-serif;
        background-color: var(--darker);
        color: var(--light);
        overflow-x: hidden;
        min-height: 100vh;
        background-image: 
            radial-gradient(circle at 10% 20%, rgba(67, 97, 238, 0.1) 0%, transparent 20%),
            radial-gradient(circle at 90% 80%, rgba(58, 12, 163, 0.1) 0%, transparent 20%);
    }
    
    /* 3. TYPOGRAPHY */
    h1, h2, h3, h4, h5, h6 {
        font-family: 'Montserrat', sans-serif;
        font-weight: 800;
    }
    
    h1 { font-size: clamp(2rem, 5vw, 3.5rem); line-height: 1.1; }
    h2 { font-size: clamp(1.5rem, 4vw, 2.5rem); line-height: 1.2; }
    h3 { font-size: clamp(1.25rem, 3vw, 2rem); line-height: 1.3; }
    h4 { font-size: clamp(1rem, 2.5vw, 1.5rem); line-height: 1.4; }
    
    .text-gradient {
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
    }
    
    /* 4. LAYOUT UTILITIES */
    .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 1rem;
    }
    
    .section {
        padding: 2rem 0;
    }
    
    .grid {
        display: grid;
        gap: 1rem;
    }
    
    .grid-2 { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
    .grid-3 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }
    .grid-4 { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
    
    .flex {
        display: flex;
    }
    
    .flex-col {
        flex-direction: column;
    }
    
    .items-center {
        align-items: center;
    }
    
    .justify-between {
        justify-content: space-between;
    }
    
    .gap-1 { gap: 0.5rem; }
    .gap-2 { gap: 1rem; }
    .gap-3 { gap: 1.5rem; }
    .gap-4 { gap: 2rem; }
    
    /* 5. BUTTONS */
    .btn {
        padding: 0.75rem 1.5rem;
        border-radius: var(--radius);
        font-weight: 600;
        font-family: 'Poppins', sans-serif;
        border: none;
        cursor: pointer;
        transition: var(--transition);
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.95rem;
        white-space: nowrap;
    }
    
    .btn-primary {
        background: var(--gradient-primary);
        color: white;
    }
    
    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
    }
    
    .btn-secondary {
        background: var(--gradient-accent);
        color: white;
    }
    
    .btn-success {
        background: var(--gradient-success);
        color: white;
    }
    
    .btn-outline {
        background: transparent;
        border: 2px solid var(--primary);
        color: var(--primary);
    }
    
    .btn-outline:hover {
        background: var(--primary);
        color: white;
    }
    
    .btn-sm {
        padding: 0.5rem 1rem;
        font-size: 0.875rem;
    }
    
    .btn-lg {
        padding: 1rem 2rem;
        font-size: 1.1rem;
    }
    
    /* 6. CARDS */
    .card {
        background: rgba(30, 41, 59, 0.7);
        backdrop-filter: blur(10px);
        border-radius: var(--radius-lg);
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: var(--transition);
        overflow: hidden;
    }
    
    .card:hover {
        transform: translateY(-5px);
        border-color: var(--primary);
        box-shadow: var(--shadow-xl);
    }
    
    .card-header {
        padding: 1rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        background: rgba(0, 0, 0, 0.2);
    }
    
    .card-body {
        padding: 1rem;
    }
    
    .card-footer {
        padding: 1rem;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        background: rgba(0, 0, 0, 0.1);
    }
    
    /* 7. FORMS */
    .form-group {
        margin-bottom: 1rem;
    }
    
    .form-label {
        display: block;
        margin-bottom: 0.5rem;
        color: var(--light);
        font-weight: 500;
    }
    
    .form-control {
        width: 100%;
        padding: 0.75rem 1rem;
        border-radius: var(--radius);
        background: rgba(15, 23, 42, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: var(--light);
        font-family: 'Poppins', sans-serif;
        transition: var(--transition);
        font-size: 16px; /* Mencegah zoom di mobile */
    }
    
    .form-control:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }
    
    .form-select {
        width: 100%;
        padding: 0.75rem 1rem;
        border-radius: var(--radius);
        background: rgba(15, 23, 42, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: var(--light);
        font-family: 'Poppins', sans-serif;
        cursor: pointer;
        font-size: 16px;
    }
    
    /* 8. TABLES */
    .table {
        width: 100%;
        border-collapse: collapse;
        background: rgba(30, 41, 59, 0.7);
        border-radius: var(--radius);
        overflow: hidden;
    }
    
    .table th {
        background: rgba(67, 97, 238, 0.2);
        padding: 0.75rem;
        text-align: left;
        font-weight: 600;
        color: var(--light);
        font-size: 0.875rem;
    }
    
    .table td {
        padding: 0.75rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        font-size: 0.875rem;
    }
    
    .table tr:hover {
        background: rgba(67, 97, 238, 0.1);
    }
    
    /* 9. BADGES */
    .badge {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: var(--radius-full);
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        white-space: nowrap;
    }
    
    .badge-primary {
        background: rgba(67, 97, 238, 0.2);
        color: var(--primary);
    }
    
    .badge-success {
        background: rgba(16, 185, 129, 0.2);
        color: var(--success);
    }
    
    .badge-warning {
        background: rgba(245, 158, 11, 0.2);
        color: var(--warning);
    }
    
    .badge-danger {
        background: rgba(239, 68, 68, 0.2);
        color: var(--danger);
    }
    
    /* 10. NAVIGATION */
    .navbar {
        background: rgba(15, 23, 42, 0.95);
        backdrop-filter: blur(10px);
        position: sticky;
        top: 0;
        z-index: var(--z-sticky);
        border-bottom: 2px solid var(--primary);
        padding: 0.75rem 0;
    }
    
    .nav-link {
        color: var(--light);
        text-decoration: none;
        padding: 0.5rem;
        border-radius: var(--radius);
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
        white-space: nowrap;
    }
    
    .nav-link:hover, .nav-link.active {
        background: rgba(67, 97, 238, 0.2);
        color: white;
    }
    
    /* 11. MODALS */
    .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: var(--z-modal);
        padding: 1rem;
    }
    
    .modal.active {
        display: flex;
        animation: fadeIn 0.3s ease;
    }
    
    .modal-content {
        background: var(--dark);
        border-radius: var(--radius-lg);
        max-width: 600px;
        width: 100%;
        max-height: 90vh;
        overflow-y: auto;
        border: 1px solid var(--primary);
        box-shadow: var(--shadow-xl);
    }
    
    /* 12. LOADER */
    .loader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--darker);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: var(--z-modal);
        flex-direction: column;
        gap: 1rem;
    }
    
    .spinner {
        width: 60px;
        height: 60px;
        border: 4px solid rgba(67, 97, 238, 0.2);
        border-top-color: var(--primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }
    
    /* 13. RESPONSIVE TABLE */
    .table-responsive {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
    
    /* 14. TELEGRAM SPECIFIC */
    .telegram-btn {
        background: #0088cc;
        color: white;
    }
    
    .telegram-btn:hover {
        background: #0077b5;
    }
    
    .telegram-notification {
        background: rgba(0, 136, 204, 0.1);
        border-left: 4px solid #0088cc;
    }
    
    /* 15. MOBILE MENU */
    .mobile-menu-btn {
        display: none;
        background: transparent;
        border: none;
        color: white;
        font-size: 1.5rem;
        cursor: pointer;
        padding: 0.5rem;
    }
    
    .mobile-menu {
        position: fixed;
        top: 70px;
        left: 0;
        right: 0;
        background: var(--dark);
        z-index: var(--z-modal);
        padding: 1rem;
        display: none;
        flex-direction: column;
        gap: 0.5rem;
        border-top: 1px solid var(--primary);
        box-shadow: var(--shadow-xl);
    }
    
    .mobile-menu.active {
        display: flex;
    }
    
    /* 16. ANIMATIONS */
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    .animate-fadeIn {
        animation: fadeIn 0.5s ease;
    }
    
    .animate-fadeInUp {
        animation: fadeInUp 0.5s ease;
    }
    
    /* 17. DARK MODE */
    .light-mode {
        --dark: #f8fafc;
        --darker: #e2e8f0;
        --light: #0f172a;
        background-color: #f1f5f9;
        color: #0f172a;
    }
    
    .light-mode .card {
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    .light-mode .navbar {
        background: rgba(255, 255, 255, 0.95);
    }
    
    .light-mode .form-control {
        background: white;
        border: 1px solid rgba(0, 0, 0, 0.2);
        color: #0f172a;
    }
    
    /* 18. SCROLLBAR */
    ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }
    
    ::-webkit-scrollbar-track {
        background: rgba(15, 23, 42, 0.5);
        border-radius: var(--radius);
    }
    
    ::-webkit-scrollbar-thumb {
        background: var(--gradient-primary);
        border-radius: var(--radius);
    }
    
    ::-webkit-scrollbar-thumb:hover {
        background: var(--primary);
    }
    
    /* 19. UTILITIES */
    .text-center { text-align: center; }
    .text-right { text-align: right; }
    .text-left { text-align: left; }
    
    .mt-1 { margin-top: 0.5rem; }
    .mt-2 { margin-top: 1rem; }
    .mt-3 { margin-top: 1.5rem; }
    .mt-4 { margin-top: 2rem; }
    
    .mb-1 { margin-bottom: 0.5rem; }
    .mb-2 { margin-bottom: 1rem; }
    .mb-3 { margin-bottom: 1.5rem; }
    .mb-4 { margin-bottom: 2rem; }
    
    .p-1 { padding: 0.5rem; }
    .p-2 { padding: 1rem; }
    .p-3 { padding: 1.5rem; }
    .p-4 { padding: 2rem; }
    
    .w-100 { width: 100%; }
    .w-50 { width: 50%; }
    
    .hidden { display: none; }
    .block { display: block; }
    
    /* 20. SPACE Y */
    .space-y-3 > * + * {
        margin-top: 0.75rem;
    }
    
    /* 21. STAT CARD */
    .stat-card {
        text-align: center;
        padding: 1.5rem 1rem;
    }
    
    .stat-number {
        font-size: clamp(2rem, 5vw, 3rem);
        font-weight: 800;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        line-height: 1;
    }
    
    .stat-label {
        font-size: 0.875rem;
        color: var(--light);
        opacity: 0.8;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    
    /* 22. TOAST NOTIFICATION */
    .toast {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
        min-width: 300px;
        max-width: 90vw;
    }
    
    /* 23. RESPONSIVE */
    @media (max-width: 1200px) {
        .grid-4 { grid-template-columns: repeat(3, 1fr); }
    }
    
    @media (max-width: 992px) {
        .grid-4, .grid-3 { grid-template-columns: repeat(2, 1fr); }
        .container { padding: 0 1rem; }
    }
    
    @media (max-width: 768px) {
        .mobile-menu-btn {
            display: block;
        }
        
        .nav-links {
            display: none;
        }
        
        .grid-4, .grid-3, .grid-2 { 
            grid-template-columns: 1fr; 
        }
        
        .section { 
            padding: 1.5rem 0; 
        }
        
        .btn-lg { 
            padding: 0.875rem 1.5rem; 
        }
        
        .table th, .table td {
            padding: 0.5rem;
            font-size: 0.8rem;
        }
        
        .card-body, .card-header, .card-footer { 
            padding: 0.75rem; 
        }
    }
    
    @media (max-width: 576px) {
        .container { 
            padding: 0 0.75rem; 
        }
        
        .section { 
            padding: 1rem 0; 
        }
        
        .flex-wrap {
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }
    }
    
    /* 24. TELEGRAM WEB APP ADJUSTMENTS */
    @media (max-width: 768px) {
        :root {
            scroll-padding-top: 60px;
        }
        
        .navbar {
            padding: 0.5rem 0;
        }
    }
    
    /* 25. ACCESSIBILITY */
    .focus-visible:focus {
        outline: 2px solid var(--primary);
        outline-offset: 2px;
    }
    </style>
</head>
<body>
    <!-- LOADING SCREEN -->
    <div class="loader" id="loader">
        <div class="spinner"></div>
        <h2 class="mt-2">MEMUAT PORTAL KELAS 8I...</h2>
        <p class="mt-1">Silakan tunggu sebentar</p>
    </div>

    <!-- NAVBAR -->
    <nav class="navbar">
        <div class="container flex items-center justify-between">
            <div class="flex items-center gap-3">
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="icon" style="width: 40px; height: 40px; border-radius: var(--radius); background: var(--gradient-primary); display: flex; align-items: center; justify-content: center; font-weight: 600; color: white;">8I</div>
                <div>
                    <h3 class="text-gradient" style="font-size: 1.25rem;">KELAS 8I</h3>
                    <p style="font-size: 0.75rem; opacity: 0.8;">SMP Negeri 7 Kotabumi Selatan</p>
                </div>
            </div>

            <div class="nav-links flex items-center gap-2">
                <a href="#home" class="nav-link active"><i class="fas fa-home"></i> Home</a>
                <a href="#students" class="nav-link"><i class="fas fa-users"></i> Siswa</a>
                <a href="#grades" class="nav-link"><i class="fas fa-chart-line"></i> Nilai</a>
                <a href="#schedule" class="nav-link"><i class="fas fa-calendar"></i> Jadwal</a>
                <a href="#tasks" class="nav-link"><i class="fas fa-tasks"></i> Tugas</a>
                
                <div class="dropdown">
                    <button class="btn btn-sm btn-outline">
                        <i class="fas fa-cog"></i> Menu
                    </button>
                    <div class="dropdown-menu">
                        <a href="#gallery" class="dropdown-item"><i class="fas fa-images"></i> Galeri</a>
                        <a href="#forum" class="dropdown-item"><i class="fas fa-comments"></i> Forum</a>
                        <a href="#telegram" class="dropdown-item"><i class="fab fa-telegram"></i> Telegram</a>
                        <a href="#attendance" class="dropdown-item"><i class="fas fa-clipboard-check"></i> Presensi</a>
                    </div>
                </div>
                
                <button class="btn btn-sm btn-primary" id="themeToggle">
                    <i class="fas fa-moon"></i> Mode
                </button>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div class="mobile-menu" id="mobileMenu">
            <a href="#home" class="nav-link active"><i class="fas fa-home"></i> Home</a>
            <a href="#students" class="nav-link"><i class="fas fa-users"></i> Siswa</a>
            <a href="#grades" class="nav-link"><i class="fas fa-chart-line"></i> Nilai</a>
            <a href="#schedule" class="nav-link"><i class="fas fa-calendar"></i> Jadwal</a>
            <a href="#tasks" class="nav-link"><i class="fas fa-tasks"></i> Tugas</a>
            <a href="#gallery" class="nav-link"><i class="fas fa-images"></i> Galeri</a>
            <a href="#forum" class="nav-link"><i class="fas fa-comments"></i> Forum</a>
            <a href="#telegram" class="nav-link"><i class="fab fa-telegram"></i> Telegram</a>
            <a href="#attendance" class="nav-link"><i class="fas fa-clipboard-check"></i> Presensi</a>
            <button class="btn btn-primary mt-2" id="mobileThemeToggle">
                <i class="fas fa-moon"></i> Ganti Mode
            </button>
        </div>
    </nav>

    <!-- HERO SECTION -->
    <section id="home" class="section">
        <div class="container">
            <div class="text-center animate-fadeInUp">
                <h1 class="text-gradient mb-2">PORTAL DIGITAL KELAS 8I</h1>
                <p class="mb-4" style="font-size: 1rem; max-width: 800px; margin: 0 auto;">
                    Platform pembelajaran digital dengan fitur lengkap untuk siswa, guru, dan orang tua
                </p>
                
                <div class="flex gap-2 justify-center mb-6 flex-wrap">
                    <button class="btn btn-primary btn-lg" id="quickStart">
                        <i class="fas fa-rocket"></i> Mulai Sekarang
                    </button>
                    <button class="btn btn-outline btn-lg" id="learnMore">
                        <i class="fas fa-info-circle"></i> Pelajari Fitur
                    </button>
                    <button class="btn telegram-btn btn-lg" id="telegramConnect">
                        <i class="fab fa-telegram"></i> Connect Telegram
                    </button>
                </div>
            </div>

            <!-- STATISTICS -->
            <div class="grid grid-4 mt-6">
                <div class="card stat-card">
                    <div class="stat-number" id="totalStudents">34</div>
                    <div class="stat-label">Total Siswa</div>
                </div>
                <div class="card stat-card">
                    <div class="stat-number" id="averageGrade">8.7</div>
                    <div class="stat-label">Rata-rata Nilai</div>
                </div>
                <div class="card stat-card">
                    <div class="stat-number" id="attendanceRate">97%</div>
                    <div class="stat-label">Kehadiran</div>
                </div>
                <div class="card stat-card">
                    <div class="stat-number" id="tasksCompleted">85%</div>
                    <div class="stat-label">Tugas Selesai</div>
                </div>
            </div>
        </div>
    </section>

    <!-- TELEGRAM SECTION -->
    <section id="telegram" class="section">
        <div class="container">
            <h2 class="mb-4"><i class="fab fa-telegram"></i> Integrasi Telegram</h2>
            
            <div class="grid grid-2 gap-4">
                <div class="card">
                    <div class="card-header">
                        <h4>Remote Control via Telegram</h4>
                    </div>
                    <div class="card-body">
                        <div class="telegram-notification p-3 rounded mb-4">
                            <p><strong>Bot Token:</strong> 7895181281:AAExuuGB9CiVtmgoNezFFryxy3L9lOt6TAA</p>
                            <p><strong>Chat ID:</strong> <span id="telegramChatId">-</span></p>
                            <p class="mt-2">Gunakan bot untuk mengirim notifikasi ke grup Telegram kelas</p>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Pesan Notifikasi</label>
                            <textarea class="form-control" id="telegramMessage" rows="3" placeholder="Tulis pesan notifikasi..."></textarea>
                        </div>
                        
                        <div class="grid grid-2 gap-3 mb-3">
                            <div class="form-group">
                                <label class="form-label">Tipe Notifikasi</label>
                                <select class="form-select" id="telegramType">
                                    <option value="info">Info</option>
                                    <option value="warning">Peringatan</option>
                                    <option value="urgent">Penting</option>
                                    <option value="announcement">Pengumuman</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Prioritas</label>
                                <select class="form-select" id="telegramPriority">
                                    <option value="low">Rendah</option>
                                    <option value="medium">Sedang</option>
                                    <option value="high">Tinggi</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="flex gap-2">
                            <button class="btn telegram-btn flex-1" id="testTelegram">
                                <i class="fab fa-telegram"></i> Test Kirim
                            </button>
                            <button class="btn btn-primary flex-1" id="sendTelegram">
                                <i class="fas fa-paper-plane"></i> Kirim ke Grup
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h4>Log Notifikasi</h4>
                    </div>
                    <div class="card-body">
                        <div class="scroll-area" style="max-height: 300px; overflow-y: auto;">
                            <div id="telegramLogs">
                                <!-- Logs akan dimuat di sini -->
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <h5>Fitur Telegram Bot:</h5>
                            <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                                <li>Kirim notifikasi tugas baru</li>
                                <li>Reminder deadline</li>
                                <li>Pengumuman kelas</li>
                                <li>Laporan kehadiran</li>
                                <li>Broadcast pesan penting</li>
                            </ul>
                        </div>
                        
                        <button class="btn btn-outline w-100 mt-3" id="clearLogs">
                            <i class="fas fa-trash"></i> Hapus Log
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- MAIN CONTENT -->
    <main class="container">
        <!-- SISWA SECTION -->
        <section id="students" class="section">
            <div class="flex items-center justify-between mb-4 flex-wrap gap-2">
                <h2><i class="fas fa-users"></i> Data Siswa</h2>
                <div class="flex gap-2">
                    <button class="btn btn-primary btn-sm" id="addStudentBtn">
                        <i class="fas fa-plus"></i> Tambah Siswa
                    </button>
                    <button class="btn btn-outline btn-sm" id="exportStudentsBtn">
                        <i class="fas fa-download"></i> Ekspor
                    </button>
                    <button class="btn telegram-btn btn-sm" id="notifyAllStudents">
                        <i class="fab fa-telegram"></i> Notifikasi
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-header flex items-center justify-between flex-wrap gap-2">
                    <h4>Daftar Siswa Kelas 8I</h4>
                    <div class="flex items-center gap-2">
                        <div class="form-group mb-0" style="min-width: 200px;">
                            <input type="text" class="form-control" id="searchStudent" placeholder="Cari nama siswa...">
                        </div>
                        <button class="btn btn-sm" id="filterBtn">
                            <i class="fas fa-filter"></i>
                        </button>
                    </div>
                </div>
                
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table" id="studentsTable">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Nama</th>
                                    <th>NIS</th>
                                    <th>JK</th>
                                    <th>Nilai</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="studentsTableBody">
                                <!-- Data siswa akan dimuat via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card-footer flex items-center justify-between flex-wrap gap-2">
                    <div>Total: <span id="studentCount">34</span> siswa</div>
                    <div class="pagination" id="studentPagination"></div>
                </div>
            </div>
        </section>

        <!-- NILAI SECTION -->
        <section id="grades" class="section">
            <h2 class="mb-4"><i class="fas fa-chart-line"></i> Sistem Penilaian</h2>
            
            <div class="grid grid-2 gap-4 mb-4">
                <div class="card">
                    <div class="card-header">
                        <h4>Statistik Nilai</h4>
                    </div>
                    <div class="card-body">
                        <canvas id="gradeChart" style="height: 300px;"></canvas>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h4>Input Nilai Baru</h4>
                    </div>
                    <div class="card-body">
                        <form id="gradeForm">
                            <div class="form-group">
                                <label class="form-label">Nama Siswa</label>
                                <select class="form-select" id="gradeStudent" required>
                                    <option value="">Pilih Siswa</option>
                                </select>
                            </div>
                            <div class="grid grid-2 gap-3">
                                <div class="form-group">
                                    <label class="form-label">Mata Pelajaran</label>
                                    <select class="form-select" id="gradeSubject" required>
                                        <option value="matematika">Matematika</option>
                                        <option value="ipa">IPA</option>
                                        <option value="ips">IPS</option>
                                        <option value="bahasa_indonesia">Bahasa Indonesia</option>
                                        <option value="bahasa_inggris">Bahasa Inggris</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Nilai</label>
                                    <input type="number" class="form-control" id="gradeValue" min="0" max="100" step="0.1" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Keterangan</label>
                                <textarea class="form-control" id="gradeNote" rows="2"></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary w-100 mt-2">
                                <i class="fas fa-save"></i> Simpan Nilai
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- JADWAL SECTION -->
        <section id="schedule" class="section">
            <h2 class="mb-4"><i class="fas fa-calendar"></i> Jadwal Pelajaran</h2>
            
            <div class="card">
                <div class="card-header">
                    <h4>Jadwal Minggu Ini</h4>
                </div>
                <div class="card-body">
                    <div id="scheduleCalendar"></div>
                </div>
            </div>
        </section>

        <!-- TUGAS SECTION -->
        <section id="tasks" class="section">
            <h2 class="mb-4"><i class="fas fa-tasks"></i> Manajemen Tugas</h2>
            
            <div class="card">
                <div class="card-header flex items-center justify-between flex-wrap gap-2">
                    <h4>Daftar Tugas</h4>
                    <div class="flex gap-2">
                        <button class="btn btn-primary btn-sm" id="addTaskBtn">
                            <i class="fas fa-plus"></i> Tugas Baru
                        </button>
                        <button class="btn telegram-btn btn-sm" id="notifyTasks">
                            <i class="fab fa-telegram"></i> Reminder
                        </button>
                    </div>
                </div>
                
                <div class="card-body">
                    <div class="tabs mb-4" id="taskTabs">
                        <button class="tab active" data-tab="all">Semua</button>
                        <button class="tab" data-tab="active">Aktif</button>
                        <button class="tab" data-tab="completed">Selesai</button>
                        <button class="tab" data-tab="overdue">Terlambat</button>
                    </div>
                    
                    <div id="taskList" class="space-y-3">
                        <!-- Daftar tugas akan dimuat via JavaScript -->
                    </div>
                </div>
            </div>
        </section>

        <!-- GALERI SECTION -->
        <section id="gallery" class="section">
            <h2 class="mb-4"><i class="fas fa-images"></i> Galeri Kelas</h2>
            
            <div class="card">
                <div class="card-body">
                    <div class="grid grid-4" id="galleryGrid">
                        <!-- Item galeri akan dimuat via JavaScript -->
                    </div>
                </div>
            </div>
        </section>

        <!-- FORUM SECTION -->
        <section id="forum" class="section">
            <h2 class="mb-4"><i class="fas fa-comments"></i> Forum Diskusi</h2>
            
            <div class="grid grid-2 gap-4">
                <div class="card">
                    <div class="card-header">
                        <h4>Diskusi Terbaru</h4>
                    </div>
                    <div class="card-body scroll-area" style="max-height: 400px;" id="forumList">
                        <!-- Daftar forum akan dimuat via JavaScript -->
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h4>Buat Diskusi Baru</h4>
                    </div>
                    <div class="card-body">
                        <form id="forumForm">
                            <div class="form-group">
                                <label class="form-label">Judul Diskusi</label>
                                <input type="text" class="form-control" id="forumTitle" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Kategori</label>
                                <select class="form-select" id="forumCategory" required>
                                    <option value="pelajaran">Pelajaran</option>
                                    <option value="tugas">Tugas</option>
                                    <option value="umum">Umum</option>
                                    <option value="ekstrakurikuler">Ekstrakurikuler</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Isi Diskusi</label>
                                <textarea class="form-control" id="forumContent" rows="4" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary w-100">
                                <i class="fas fa-paper-plane"></i> Buat Diskusi
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer class="section" style="background: rgba(0,0,0,0.3);">
        <div class="container">
            <div class="grid grid-4 gap-6 mb-6">
                <div>
                    <h3 class="text-gradient mb-3">KELAS 8I</h3>
                    <p>SMP Negeri 7 Kotabumi Selatan</p>
                    <p class="mt-2">Jl. Stadion Barat No. 45, Kelapa Tujuh, Kotabumi Selatan</p>
                </div>
                
                <div>
                    <h4 class="mb-3">Menu Utama</h4>
                    <div class="flex flex-col gap-2">
                        <a href="#home" class="nav-link">Home</a>
                        <a href="#students" class="nav-link">Data Siswa</a>
                        <a href="#grades" class="nav-link">Sistem Nilai</a>
                        <a href="#schedule" class="nav-link">Jadwal</a>
                    </div>
                </div>
                
                <div>
                    <h4 class="mb-3">Fitur Lain</h4>
                    <div class="flex flex-col gap-2">
                        <a href="#tasks" class="nav-link">Tugas</a>
                        <a href="#gallery" class="nav-link">Galeri</a>
                        <a href="#forum" class="nav-link">Forum</a>
                        <a href="#telegram" class="nav-link">Telegram</a>
                    </div>
                </div>
                
                <div>
                    <h4 class="mb-3">Kontak</h4>
                    <p><i class="fas fa-user"></i> Perwakilan: Yama</p>
                    <p><i class="fas fa-envelope"></i> Email: yusufhisyamaa@gmail.com</p>
                    <p><i class="fas fa-phone"></i> WhatsApp: 088286708193</p>
                </div>
            </div>
            
            <div class="separator" style="height: 1px; background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.2), transparent); margin: 1rem 0;"></div>
            
            <div class="text-center">
                <p>&copy; 2024 Portal Kelas 8I - SMP Negeri 7 Kotabumi Selatan. All rights reserved.</p>
                <p class="mt-1">Dibuat dengan ‚ù§Ô∏è oleh Tim IT Kelas 8I</p>
            </div>
        </div>
    </footer>

    <!-- MODALS -->
    <!-- MODAL TAMBAH SISWA -->
    <div class="modal" id="studentModal">
        <div class="modal-content">
            <div class="card-header flex items-center justify-between">
                <h3 id="modalTitle">Tambah Siswa Baru</h3>
                <button class="btn btn-sm close-modal">&times;</button>
            </div>
            
            <div class="card-body">
                <form id="studentForm">
                    <input type="hidden" id="studentId">
                    
                    <div class="grid grid-2 gap-3 mb-3">
                        <div class="form-group">
                            <label class="form-label">Nama Lengkap</label>
                            <input type="text" class="form-control" id="studentName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">NIS</label>
                            <input type="text" class="form-control" id="studentNis" required>
                        </div>
                    </div>
                    
                    <div class="grid grid-2 gap-3 mb-3">
                        <div class="form-group">
                            <label class="form-label">Jenis Kelamin</label>
                            <select class="form-select" id="studentGender" required>
                                <option value="Laki-laki">Laki-laki</option>
                                <option value="Perempuan">Perempuan</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tanggal Lahir</label>
                            <input type="date" class="form-control" id="studentBirthDate">
                        </div>
                    </div>
                    
                    <div class="form-group mb-3">
                        <label class="form-label">Alamat</label>
                        <textarea class="form-control" id="studentAddress" rows="2"></textarea>
                    </div>
                    
                    <div class="grid grid-2 gap-3 mb-3">
                        <div class="form-group">
                            <label class="form-label">Telepon</label>
                            <input type="tel" class="form-control" id="studentPhone">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" id="studentEmail">
                        </div>
                    </div>
                    
                    <div class="flex gap-2">
                        <button type="button" class="btn btn-outline flex-1 close-modal">Batal</button>
                        <button type="submit" class="btn btn-primary flex-1">
                            <i class="fas fa-save"></i> Simpan
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- MODAL TAMBAH TUGAS -->
    <div class="modal" id="taskModal">
        <div class="modal-content">
            <div class="card-header flex items-center justify-between">
                <h3>Tambah Tugas Baru</h3>
                <button class="btn btn-sm close-modal">&times;</button>
            </div>
            
            <div class="card-body">
                <form id="taskForm">
                    <div class="form-group mb-3">
                        <label class="form-label">Judul Tugas</label>
                        <input type="text" class="form-control" id="taskTitle" required>
                    </div>
                    
                    <div class="grid grid-2 gap-3 mb-3">
                        <div class="form-group">
                            <label class="form-label">Mata Pelajaran</label>
                            <select class="form-select" id="taskSubject" required>
                                <option value="matematika">Matematika</option>
                                <option value="ipa">IPA</option>
                                <option value="ips">IPS</option>
                                <option value="bahasa">Bahasa Indonesia</option>
                                <option value="inggris">Bahasa Inggris</option>
                                <option value="other">Lainnya</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Batas Waktu</label>
                            <input type="datetime-local" class="form-control" id="taskDeadline" required>
                        </div>
                    </div>
                    
                    <div class="form-group mb-3">
                        <label class="form-label">Deskripsi Tugas</label>
                        <textarea class="form-control" id="taskDescription" rows="3" required></textarea>
                    </div>
                    
                    <div class="form-group mb-4">
                        <label class="form-label">Kirim notifikasi ke Telegram?</label>
                        <div class="flex items-center gap-2">
                            <input type="checkbox" id="sendTelegramNotification" checked>
                            <label for="sendTelegramNotification">Ya, kirim notifikasi</label>
                        </div>
                    </div>
                    
                    <div class="flex gap-2">
                        <button type="button" class="btn btn-outline flex-1 close-modal">Batal</button>
                        <button type="submit" class="btn btn-primary flex-1">
                            <i class="fas fa-plus"></i> Tambah
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- NOTIFICATION TOAST -->
    <div id="toast" class="hidden toast">
        <div class="card animate-fadeInUp" style="min-width: 300px;">
            <div class="card-body flex items-center gap-3">
                <i class="fas fa-check-circle" style="color: var(--success); font-size: 1.5rem;"></i>
                <div>
                    <h4 class="mb-1" id="toastTitle">Sukses</h4>
                    <p id="toastMessage">Operasi berhasil dilakukan</p>
                </div>
            </div>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
    // ========== MEGA JAVASCRIPT (250KB+) ==========
    
    // 1. TELEGRAM BOT CONFIG
    const TELEGRAM_BOT_TOKEN = '7895181281:AAExuuGB9CiVtmgoNezFFryxy3L9lOt6TAA';
    const TELEGRAM_CHAT_ID = '7651689928'; // Ini adalah chat ID kamu
    
    // 2. DATA UTAMA
    const initialStudents = [
        { id: 1, name: "ALAN KHOIRUL", nis: "001", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.5, attendance: 95, status: "Aktif" },
        { id: 2, name: "ALBIE ALFARIZA RACHMADHANI", nis: "002", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.7, attendance: 98, status: "Aktif" },
        { id: 3, name: "ALI IQBAL", nis: "003", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.3, attendance: 92, status: "Aktif" },
        { id: 4, name: "ALKILLA AFIFA", nis: "004", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 9.0, attendance: 100, status: "Aktif" },
        { id: 5, name: "AMELIA CHANTIKA PRATIWI", nis: "005", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.8, attendance: 96, status: "Aktif" },
        { id: 6, name: "AN ASBY ANGGARA", nis: "006", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.4, attendance: 94, status: "Aktif" },
        { id: 7, name: "ANISA PRASTYA PUTRI", nis: "007", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.9, attendance: 99, status: "Aktif" },
        { id: 8, name: "ANTIQA T", nis: "008", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.6, attendance: 97, status: "Aktif" },
        { id: 9, name: "AQILAH RAHMAHDHANI ZIKRILLAH", nis: "009", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.7, attendance: 95, status: "Aktif" },
        { id: 10, name: "AQILLA AZZALEA ANABIYU", nis: "010", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.5, attendance: 93, status: "Aktif" },
        { id: 11, name: "ARYA BANGSA JAYA", nis: "011", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.2, attendance: 91, status: "Aktif" },
        { id: 12, name: "ASHILAH DZAKIYAH", nis: "012", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.8, attendance: 98, status: "Aktif" },
        { id: 13, name: "ATHA ANASTASYA KHANSA", nis: "013", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.9, attendance: 100, status: "Aktif" },
        { id: 14, name: "ATIRI HAFIZ FEBRIZIO", nis: "014", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.4, attendance: 94, status: "Aktif" },
        { id: 15, name: "BILQIS ZASKIA ARFAN", nis: "015", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.7, attendance: 96, status: "Aktif" },
        { id: 16, name: "CELLO GAVIN SAPUTRA", nis: "016", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.3, attendance: 92, status: "Aktif" },
        { id: 17, name: "DZAKI DZULHANNAN", nis: "017", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.5, attendance: 95, status: "Aktif" },
        { id: 18, name: "GHEZI IQBAL ABIYA", nis: "018", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.6, attendance: 97, status: "Aktif" },
        { id: 19, name: "HANUN KHAIRUNISA", nis: "019", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.8, attendance: 99, status: "Aktif" },
        { id: 20, name: "KALILLAH MASYA ANTAMA", nis: "020", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.9, attendance: 100, status: "Aktif" },
        { id: 21, name: "KEYZA AZZAHRA SHIDIQ", nis: "021", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.7, attendance: 98, status: "Aktif" },
        { id: 22, name: "M.ALDO PRATAMA", nis: "022", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.4, attendance: 93, status: "Aktif" },
        { id: 23, name: "MAESYA NAYRA SALSABILLA", nis: "023", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.8, attendance: 97, status: "Aktif" },
        { id: 24, name: "MAYANG SETIAJI", nis: "024", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.6, attendance: 96, status: "Aktif" },
        { id: 25, name: "MUAMMAR TANGGUH RAMDANI", nis: "025", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.5, attendance: 94, status: "Aktif" },
        { id: 26, name: "MUHAMAD SULTAN AZIZ", nis: "026", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.3, attendance: 92, status: "Aktif" },
        { id: 27, name: "MUHAMMAD ABRAHAM ALI HASAN", nis: "027", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.7, attendance: 98, status: "Aktif" },
        { id: 28, name: "MUHAMMAD RAMSES CALM", nis: "028", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.4, attendance: 95, status: "Aktif" },
        { id: 29, name: "MUHAMMAD RASYA ATHAYA, SP", nis: "029", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.6, attendance: 97, status: "Aktif" },
        { id: 30, name: "NASYWA ROHADATUL AISY", nis: "030", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.9, attendance: 100, status: "Aktif" },
        { id: 31, name: "QUEEN NAURA GRNETHA AWANG", nis: "031", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.8, attendance: 99, status: "Aktif" },
        { id: 32, name: "QURROTA AYUN WULAN RAMADHANI", nis: "032", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.7, attendance: 98, status: "Aktif" },
        { id: 33, name: "RAISA AZRA LATIFA", nis: "033", gender: "Perempuan", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 8.9, attendance: 100, status: "Aktif" },
        { id: 34, name: "YUSUF HISYAMA WIJAYA", nis: "034", gender: "Laki-laki", address: "", phone: "", email: "", parent: "", birthDate: "", averageGrade: 9.2, attendance: 100, status: "Aktif" }
    ];

    const initialTasks = [
        { id: 1, title: "Tugas Matematika - Bab 1", subject: "matematika", description: "Kerjakan soal halaman 10-15", deadline: "2024-01-20T23:59", priority: "high", status: "active", createdAt: "2024-01-15" },
        { id: 2, title: "Laporan IPA", subject: "ipa", description: "Buat laporan praktikum tentang fotosintesis", deadline: "2024-01-25T23:59", priority: "medium", status: "active", createdAt: "2024-01-16" },
        { id: 3, title: "Membaca Novel", subject: "bahasa", description: "Baca novel halaman 1-50", deadline: "2024-01-18T23:59", priority: "low", status: "completed", createdAt: "2024-01-10" },
        { id: 4, title: "English Essay", subject: "inggris", description: "Write 300-word essay about your holiday", deadline: "2024-01-22T23:59", priority: "medium", status: "active", createdAt: "2024-01-14" },
        { id: 5, title: "Peta Konsep IPS", subject: "ips", description: "Buat peta konsep bab kolonialisme", deadline: "2024-01-30T23:59", priority: "low", status: "active", createdAt: "2024-01-17" }
    ];

    const initialGrades = [
        { id: 1, studentId: 1, subject: "matematika", value: 8.5, date: "2024-01-15", note: "UTS Semester 1" },
        { id: 2, studentId: 1, subject: "ipa", value: 8.7, date: "2024-01-16", note: "UTS Semester 1" },
        { id: 3, studentId: 2, subject: "matematika", value: 8.8, date: "2024-01-15", note: "UTS Semester 1" },
        { id: 4, studentId: 2, subject: "ipa", value: 9.0, date: "2024-01-16", note: "UTS Semester 1" },
        { id: 5, studentId: 34, subject: "matematika", value: 9.5, date: "2024-01-15", note: "UTS Semester 1" }
    ];

    const initialForum = [
        { id: 1, title: "Pembahasan Soal Matematika", category: "pelajaran", author: "Yama", content: "Ada yang bisa bantu soal nomor 5 halaman 20?", date: "2024-01-15", replies: 5 },
        { id: 2, title: "Info Ekstrakurikuler", category: "ekstrakurikuler", author: "Guru", content: "Pendaftaran ekstrakurikuler dibuka mulai besok", date: "2024-01-14", replies: 12 },
        { id: 3, title: "Deadline Tugas IPA", category: "tugas", author: "Ali", content: "Kapan deadline tugas IPA yang terakhir?", date: "2024-01-13", replies: 3 },
        { id: 4, title: "Persiapan Ujian", category: "pelajaran", author: "Amelia", content: "Ada yang mau belajar kelompok untuk persiapan ujian?", date: "2024-01-12", replies: 8 }
    ];

    // 3. STATE MANAGEMENT
    let students = JSON.parse(localStorage.getItem('portal8i_students')) || initialStudents;
    let tasks = JSON.parse(localStorage.getItem('portal8i_tasks')) || initialTasks;
    let grades = JSON.parse(localStorage.getItem('portal8i_grades')) || initialGrades;
    let forum = JSON.parse(localStorage.getItem('portal8i_forum')) || initialForum;
    let telegramLogs = JSON.parse(localStorage.getItem('portal8i_telegram_logs')) || [];
    let currentPage = 1;
    const itemsPerPage = 10;

    // 4. TELEGRAM FUNCTIONS
    async function sendTelegramMessage(message) {
        try {
            const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
            
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: TELEGRAM_CHAT_ID,
                    text: message,
                    parse_mode: 'HTML'
                })
            });
            
            const result = await response.json();
            
            // Log the result
            const logEntry = {
                id: Date.now(),
                timestamp: new Date().toISOString(),
                message: message,
                success: result.ok,
                response: result
            };
            
            telegramLogs.unshift(logEntry);
            if (telegramLogs.length > 50) telegramLogs.pop();
            
            localStorage.setItem('portal8i_telegram_logs', JSON.stringify(telegramLogs));
            renderTelegramLogs();
            
            return result.ok;
            
        } catch (error) {
            console.error('Error sending Telegram message:', error);
            
            const logEntry = {
                id: Date.now(),
                timestamp: new Date().toISOString(),
                message: message,
                success: false,
                error: error.message
            };
            
            telegramLogs.unshift(logEntry);
            if (telegramLogs.length > 50) telegramLogs.pop();
            
            localStorage.setItem('portal8i_telegram_logs', JSON.stringify(telegramLogs));
            renderTelegramLogs();
            
            return false;
        }
    }

    function renderTelegramLogs() {
        const logsContainer = document.getElementById('telegramLogs');
        logsContainer.innerHTML = '';
        
        if (telegramLogs.length === 0) {
            logsContainer.innerHTML = '<p class="text-center opacity-75">Belum ada log notifikasi</p>';
            return;
        }
        
        telegramLogs.forEach(log => {
            const logElement = document.createElement('div');
            logElement.className = `mb-3 p-3 rounded ${log.success ? 'bg-green-900/20' : 'bg-red-900/20'}`;
            logElement.innerHTML = `
                <div class="flex justify-between items-start mb-1">
                    <span class="text-sm font-semibold">${new Date(log.timestamp).toLocaleTimeString('id-ID')}</span>
                    <span class="badge ${log.success ? 'badge-success' : 'badge-danger'}">
                        ${log.success ? 'Berhasil' : 'Gagal'}
                    </span>
                </div>
                <p class="text-sm opacity-90">${log.message.substring(0, 100)}${log.message.length > 100 ? '...' : ''}</p>
            `;
            logsContainer.appendChild(logElement);
        });
    }

    function formatTelegramMessage(type, message, priority = 'medium') {
        const emojis = {
            info: '‚ÑπÔ∏è',
            warning: '‚ö†Ô∏è',
            urgent: 'üö®',
            announcement: 'üì¢'
        };
        
        const priorities = {
            low: 'üîµ',
            medium: 'üü°',
            high: 'üî¥'
        };
        
        return `
${emojis[type] || 'üìù'} <b>${type.toUpperCase()} - PORTAL KELAS 8I</b>
${priorities[priority] || 'üü°'} Priority: ${priority.toUpperCase()}

${message}

üìÖ ${new Date().toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
üïí ${new Date().toLocaleTimeString('id-ID')}

<code>=== SMPN 7 Kotabumi Selatan ===</code>
        `;
    }

    // 5. UTILITY FUNCTIONS
    function saveToStorage() {
        localStorage.setItem('portal8i_students', JSON.stringify(students));
        localStorage.setItem('portal8i_tasks', JSON.stringify(tasks));
        localStorage.setItem('portal8i_grades', JSON.stringify(grades));
        localStorage.setItem('portal8i_forum', JSON.stringify(forum));
    }

    function showToast(title, message, type = 'success') {
        const toast = document.getElementById('toast');
        const toastTitle = document.getElementById('toastTitle');
        const toastMessage = document.getElementById('toastMessage');
        const icon = toast.querySelector('i');
        
        toastTitle.textContent = title;
        toastMessage.textContent = message;
        
        switch(type) {
            case 'success':
                icon.className = 'fas fa-check-circle';
                icon.style.color = 'var(--success)';
                break;
            case 'error':
                icon.className = 'fas fa-times-circle';
                icon.style.color = 'var(--danger)';
                break;
            case 'warning':
                icon.className = 'fas fa-exclamation-triangle';
                icon.style.color = 'var(--warning)';
                break;
            case 'info':
                icon.className = 'fas fa-info-circle';
                icon.style.color = 'var(--info)';
                break;
        }
        
        toast.classList.remove('hidden');
        
        setTimeout(() => {
            toast.classList.add('hidden');
        }, 3000);
    }

    function formatDate(dateString) {
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        return new Date(dateString).toLocaleDateString('id-ID', options);
    }

    function formatDateTime(dateTimeString) {
        const date = new Date(dateTimeString);
        return date.toLocaleDateString('id-ID') + ' ' + date.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
    }

    // 6. STUDENT MANAGEMENT
    function renderStudents(page = 1, search = '') {
        const tableBody = document.getElementById('studentsTableBody');
        const studentCount = document.getElementById('studentCount');
        const pagination = document.getElementById('studentPagination');
        
        let filteredStudents = students;
        
        if (search) {
            filteredStudents = students.filter(student => 
                student.name.toLowerCase().includes(search.toLowerCase()) ||
                student.nis.includes(search)
            );
        }
        
        studentCount.textContent = filteredStudents.length;
        
        const totalPages = Math.ceil(filteredStudents.length / itemsPerPage);
        const startIndex = (page - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const paginatedStudents = filteredStudents.slice(startIndex, endIndex);
        
        tableBody.innerHTML = '';
        
        paginatedStudents.forEach((student, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${startIndex + index + 1}</td>
                <td>
                    <div class="flex items-center gap-2">
                        <div style="width: 30px; height: 30px; border-radius: 50%; background: var(--gradient-primary); display: flex; align-items: center; justify-content: center; font-weight: 600; color: white; font-size: 0.875rem;">
                            ${student.name.charAt(0)}
                        </div>
                        <div>
                            <div class="font-semibold" style="font-size: 0.875rem;">${student.name}</div>
                            <div class="text-xs opacity-75">${student.email || 'Belum diisi'}</div>
                        </div>
                    </div>
                </td>
                <td>${student.nis}</td>
                <td>${student.gender === 'Laki-laki' ? 'L' : 'P'}</td>
                <td>
                    <div class="flex items-center gap-2">
                        <div class="progress" style="flex: 1; height: 6px;">
                            <div class="progress-bar" style="width: ${(student.averageGrade / 10) * 100}%"></div>
                        </div>
                        <span class="font-semibold" style="font-size: 0.875rem;">${student.averageGrade.toFixed(1)}</span>
                    </div>
                </td>
                <td>
                    <span class="badge ${student.status === 'Aktif' ? 'badge-success' : 'badge-danger'}" style="font-size: 0.7rem;">
                        ${student.status}
                    </span>
                </td>
                <td>
                    <div class="flex gap-1">
                        <button class="btn btn-sm btn-outline" onclick="editStudent(${student.id})" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-outline" onclick="deleteStudent(${student.id})" title="Hapus">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            `;
            tableBody.appendChild(row);
        });
        
        renderPagination(pagination, totalPages, page);
    }

    function renderPagination(element, totalPages, currentPage) {
        element.innerHTML = '';
        
        if (totalPages <= 1) return;
        
        // Previous button
        if (currentPage > 1) {
            const prevItem = document.createElement('li');
            prevItem.className = 'page-item';
            const prevLink = document.createElement('a');
            prevLink.className = 'page-link';
            prevLink.href = '#';
            prevLink.innerHTML = '<i class="fas fa-chevron-left"></i>';
            prevLink.onclick = (e) => {
                e.preventDefault();
                renderStudents(currentPage - 1, document.getElementById('searchStudent').value);
            };
            prevItem.appendChild(prevLink);
            element.appendChild(prevItem);
        }
        
        // Page numbers
        for (let i = 1; i <= totalPages; i++) {
            const pageItem = document.createElement('li');
            pageItem.className = 'page-item';
            const pageLink = document.createElement('a');
            pageLink.className = `page-link ${i === currentPage ? 'active' : ''}`;
            pageLink.href = '#';
            pageLink.textContent = i;
            pageLink.onclick = (e) => {
                e.preventDefault();
                renderStudents(i, document.getElementById('searchStudent').value);
            };
            pageItem.appendChild(pageLink);
            element.appendChild(pageItem);
        }
        
        // Next button
        if (currentPage < totalPages) {
            const nextItem = document.createElement('li');
            nextItem.className = 'page-item';
            const nextLink = document.createElement('a');
            nextLink.className = 'page-link';
            nextLink.href = '#';
            nextLink.innerHTML = '<i class="fas fa-chevron-right"></i>';
            nextLink.onclick = (e) => {
                e.preventDefault();
                renderStudents(currentPage + 1, document.getElementById('searchStudent').value);
            };
            nextItem.appendChild(nextLink);
            element.appendChild(nextItem);
        }
    }

    function openStudentModal(student = null) {
        const modal = document.getElementById('studentModal');
        const modalTitle = document.getElementById('modalTitle');
        const studentId = document.getElementById('studentId');
        const form = document.getElementById('studentForm');
        
        if (student) {
            modalTitle.textContent = 'Edit Data Siswa';
            studentId.value = student.id;
            document.getElementById('studentName').value = student.name;
            document.getElementById('studentNis').value = student.nis;
            document.getElementById('studentGender').value = student.gender;
            document.getElementById('studentBirthDate').value = student.birthDate;
            document.getElementById('studentAddress').value = student.address;
            document.getElementById('studentParent').value = student.parent;
            document.getElementById('studentPhone').value = student.phone;
            document.getElementById('studentEmail').value = student.email;
        } else {
            modalTitle.textContent = 'Tambah Siswa Baru';
            studentId.value = '';
            form.reset();
        }
        
        modal.classList.add('active');
    }

    function editStudent(id) {
        const student = students.find(s => s.id === id);
        if (student) {
            openStudentModal(student);
        }
    }

    function deleteStudent(id) {
        if (confirm('Apakah Anda yakin ingin menghapus siswa ini?')) {
            students = students.filter(student => student.id !== id);
            saveToStorage();
            renderStudents(currentPage);
            showToast('Berhasil', 'Data siswa berhasil dihapus', 'success');
            updateStatistics();
        }
    }

    // 7. TASK MANAGEMENT
    function renderTasks(filter = 'all') {
        const taskList = document.getElementById('taskList');
        let filteredTasks = tasks;
        
        if (filter !== 'all') {
            filteredTasks = tasks.filter(task => task.status === filter);
        }
        
        taskList.innerHTML = '';
        
        if (filteredTasks.length === 0) {
            taskList.innerHTML = '<p class="text-center opacity-75">Tidak ada tugas</p>';
            return;
        }
        
        filteredTasks.forEach(task => {
            const isOverdue = new Date(task.deadline) < new Date() && task.status !== 'completed';
            
            const taskElement = document.createElement('div');
            taskElement.className = 'card hover-lift';
            taskElement.innerHTML = `
                <div class="card-body">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center gap-2">
                            <span class="badge ${
                                task.priority === 'high' ? 'badge-danger' : 
                                task.priority === 'medium' ? 'badge-warning' : 'badge-success'
                            }">
                                ${task.priority === 'high' ? 'Tinggi' : task.priority === 'medium' ? 'Sedang' : 'Rendah'}
                            </span>
                            <span class="badge badge-primary">${task.subject.toUpperCase()}</span>
                        </div>
                        <div class="flex gap-1">
                            <button class="btn btn-sm btn-outline" onclick="toggleTask(${task.id})" title="${task.status === 'completed' ? 'Tandai belum selesai' : 'Tandai selesai'}">
                                <i class="fas ${task.status === 'completed' ? 'fa-redo' : 'fa-check'}"></i>
                            </button>
                            <button class="btn btn-sm btn-outline" onclick="deleteTask(${task.id})" title="Hapus">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    
                    <h4 class="mb-1" style="font-size: 1rem;">${task.title}</h4>
                    <p class="mb-2 opacity-75" style="font-size: 0.875rem;">${task.description}</p>
                    
                    <div class="flex items-center justify-between text-sm">
                        <div class="flex items-center gap-1">
                            <i class="fas fa-calendar"></i>
                            <span>${formatDateTime(task.deadline)}</span>
                        </div>
                        <span class="${
                            task.status === 'completed' ? 'badge-success' : 
                            isOverdue ? 'badge-danger' : 'badge-primary'
                        } badge">
                            ${task.status === 'completed' ? 'Selesai' : 
                              isOverdue ? 'Terlambat' : 'Aktif'}
                        </span>
                    </div>
                </div>
            `;
            taskList.appendChild(taskElement);
        });
    }

    function toggleTask(id) {
        const task = tasks.find(t => t.id === id);
        if (task) {
            task.status = task.status === 'completed' ? 'active' : 'completed';
            saveToStorage();
            renderTasks('all');
            showToast('Berhasil', `Tugas "${task.title}" telah diperbarui`, 'success');
            updateStatistics();
        }
    }

    function deleteTask(id) {
        if (confirm('Apakah Anda yakin ingin menghapus tugas ini?')) {
            tasks = tasks.filter(task => task.id !== id);
            saveToStorage();
            renderTasks('all');
            showToast('Berhasil', 'Tugas berhasil dihapus', 'success');
            updateStatistics();
        }
    }

    // 8. GRADE MANAGEMENT
    function renderGradeChart() {
        const ctx = document.getElementById('gradeChart');
        if (!ctx) return;
        
        // Hapus chart yang ada jika ada
        if (window.gradeChartInstance) {
            window.gradeChartInstance.destroy();
        }
        
        // Data untuk chart
        const subjects = ['Matematika', 'IPA', 'IPS', 'Bahasa', 'Inggris'];
        const averages = subjects.map(subject => {
            const subjectKey = subject.toLowerCase().replace(' ', '_');
            const subjectGrades = grades.filter(g => g.subject === subjectKey);
            if (subjectGrades.length === 0) return 0;
            return subjectGrades.reduce((sum, grade) => sum + grade.value, 0) / subjectGrades.length;
        });
        
        window.gradeChartInstance = new Chart(ctx.getContext('2d'), {
            type: 'bar',
            data: {
                labels: subjects,
                datasets: [{
                    label: 'Rata-rata Nilai',
                    data: averages,
                    backgroundColor: [
                        'rgba(67, 97, 238, 0.7)',
                        'rgba(16, 185, 129, 0.7)',
                        'rgba(245, 158, 11, 0.7)',
                        'rgba(239, 68, 68, 0.7)',
                        'rgba(6, 182, 212, 0.7)'
                    ],
                    borderColor: [
                        'rgb(67, 97, 238)',
                        'rgb(16, 185, 129)',
                        'rgb(245, 158, 11)',
                        'rgb(239, 68, 68)',
                        'rgb(6, 182, 212)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 10,
                        ticks: {
                            callback: function(value) {
                                return value.toFixed(1);
                            }
                        }
                    }
                }
            }
        });
    }

    function populateGradeStudents() {
        const select = document.getElementById('gradeStudent');
        if (!select) return;
        
        select.innerHTML = '<option value="">Pilih Siswa</option>';
        
        students.forEach(student => {
            const option = document.createElement('option');
            option.value = student.id;
            option.textContent = `${student.name} (NIS: ${student.nis})`;
            select.appendChild(option);
        });
    }

    // 9. FORUM MANAGEMENT
    function renderForum() {
        const forumList = document.getElementById('forumList');
        if (!forumList) return;
        
        forumList.innerHTML = '';
        
        forum.forEach(forumItem => {
            const forumElement = document.createElement('div');
            forumElement.className = 'mb-3 pb-3 border-b border-gray-700';
            forumElement.innerHTML = `
                <div class="flex items-start justify-between mb-2">
                    <div>
                        <h4 class="font-semibold" style="font-size: 0.875rem;">${forumItem.title}</h4>
                        <div class="flex items-center gap-2 text-xs opacity-75">
                            <span class="badge badge-primary">${forumItem.category}</span>
                            <span>Oleh: ${forumItem.author}</span>
                            <span>‚Ä¢</span>
                            <span>${formatDate(forumItem.date)}</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-1">
                        <i class="fas fa-comment"></i>
                        <span>${forumItem.replies}</span>
                    </div>
                </div>
                <p class="opacity-90" style="font-size: 0.875rem;">${forumItem.content}</p>
                <button class="btn btn-sm btn-outline mt-2" onclick="replyToForum(${forumItem.id})">
                    <i class="fas fa-reply"></i> Balas
                </button>
            `;
            forumList.appendChild(forumElement);
        });
    }

    function replyToForum(id) {
        const forumItem = forum.find(f => f.id === id);
        if (forumItem) {
            const reply = prompt(`Balas diskusi: ${forumItem.title}`);
            if (reply) {
                forumItem.replies++;
                saveToStorage();
                renderForum();
                showToast('Berhasil', 'Balasan telah ditambahkan', 'success');
            }
        }
    }

    // 10. STATISTICS
    function updateStatistics() {
        // Total siswa
        const totalStudentsEl = document.getElementById('totalStudents');
        if (totalStudentsEl) totalStudentsEl.textContent = students.length;
        
        // Rata-rata nilai
        const totalAverage = students.length > 0 ? 
            students.reduce((sum, student) => sum + student.averageGrade, 0) / students.length : 0;
        const averageGradeEl = document.getElementById('averageGrade');
        if (averageGradeEl) averageGradeEl.textContent = totalAverage.toFixed(1);
        
        // Rata-rata kehadiran
        const totalAttendance = students.length > 0 ? 
            students.reduce((sum, student) => sum + student.attendance, 0) / students.length : 0;
        const attendanceRateEl = document.getElementById('attendanceRate');
        if (attendanceRateEl) attendanceRateEl.textContent = Math.round(totalAttendance) + '%';
        
        // Persentase tugas selesai
        const completedTasks = tasks.filter(task => task.status === 'completed').length;
        const totalTasks = tasks.length;
        const completionRate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
        const tasksCompletedEl = document.getElementById('tasksCompleted');
        if (tasksCompletedEl) tasksCompletedEl.textContent = completionRate + '%';
    }

    // 11. EVENT LISTENERS
    function setupEventListeners() {
        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenu = document.getElementById('mobileMenu');
        if (mobileMenuBtn && mobileMenu) {
            mobileMenuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('active');
            });
            
            // Close menu when clicking outside
            document.addEventListener('click', (e) => {
                if (!mobileMenu.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
                    mobileMenu.classList.remove('active');
                }
            });
        }

        // Theme toggle
        const themeToggle = document.getElementById('themeToggle');
        const mobileThemeToggle = document.getElementById('mobileThemeToggle');
        
        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const icon = document.querySelector('#themeToggle i');
            if (document.body.classList.contains('light-mode')) {
                icon.className = 'fas fa-sun';
                localStorage.setItem('portal8i_theme', 'light');
            } else {
                icon.className = 'fas fa-moon';
                localStorage.setItem('portal8i_theme', 'dark');
            }
        }
        
        if (themeToggle) themeToggle.addEventListener('click', toggleTheme);
        if (mobileThemeToggle) mobileThemeToggle.addEventListener('click', toggleTheme);

        // Student search
        const searchStudent = document.getElementById('searchStudent');
        if (searchStudent) {
            searchStudent.addEventListener('input', (e) => {
                renderStudents(1, e.target.value);
            });
        }

        // Add student button
        const addStudentBtn = document.getElementById('addStudentBtn');
        if (addStudentBtn) {
            addStudentBtn.addEventListener('click', () => {
                openStudentModal();
            });
        }

        // Export students
        const exportStudentsBtn = document.getElementById('exportStudentsBtn');
        if (exportStudentsBtn) {
            exportStudentsBtn.addEventListener('click', () => {
                const dataStr = JSON.stringify(students, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                const exportFileDefaultName = 'siswa-kelas-8i.json';
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
                
                showToast('Berhasil', 'Data siswa berhasil diekspor', 'success');
            });
        }

        // Student form
        const studentForm = document.getElementById('studentForm');
        if (studentForm) {
            studentForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const studentId = document.getElementById('studentId').value;
                const studentName = document.getElementById('studentName').value;
                const studentNis = document.getElementById('studentNis').value;
                const studentGender = document.getElementById('studentGender').value;
                const studentBirthDate = document.getElementById('studentBirthDate').value;
                const studentAddress = document.getElementById('studentAddress').value;
                const studentParent = document.getElementById('studentParent')?.value || '';
                const studentPhone = document.getElementById('studentPhone').value;
                const studentEmail = document.getElementById('studentEmail').value;
                
                if (studentId) {
                    // Edit existing student
                    const index = students.findIndex(s => s.id == studentId);
                    if (index !== -1) {
                        students[index] = {
                            ...students[index],
                            name: studentName,
                            nis: studentNis,
                            gender: studentGender,
                            birthDate: studentBirthDate,
                            address: studentAddress,
                            parent: studentParent,
                            phone: studentPhone,
                            email: studentEmail
                        };
                        showToast('Berhasil', 'Data siswa berhasil diperbarui', 'success');
                    }
                } else {
                    // Add new student
                    const newId = students.length > 0 ? Math.max(...students.map(s => s.id)) + 1 : 1;
                    const newStudent = {
                        id: newId,
                        name: studentName,
                        nis: studentNis,
                        gender: studentGender,
                        birthDate: studentBirthDate,
                        address: studentAddress,
                        parent: studentParent,
                        phone: studentPhone,
                        email: studentEmail,
                        averageGrade: 8.5,
                        attendance: 95,
                        status: 'Aktif'
                    };
                    students.push(newStudent);
                    showToast('Berhasil', 'Siswa baru berhasil ditambahkan', 'success');
                    
                    // Send Telegram notification
                    const telegramMessage = formatTelegramMessage('info', 
                        `üìö SISWA BARU\n\n` +
                        `Nama: ${studentName}\n` +
                        `NIS: ${studentNis}\n` +
                        `Kelas: 8I\n` +
                        `Status: Aktif\n\n` +
                        `Selamat bergabung di Kelas 8I!`
                    , 'medium');
                    
                    sendTelegramMessage(telegramMessage);
                }
                
                saveToStorage();
                renderStudents(currentPage);
                updateStatistics();
                populateGradeStudents();
                
                document.getElementById('studentModal').classList.remove('active');
                studentForm.reset();
            });
        }

        // Grade form
        const gradeForm = document.getElementById('gradeForm');
        if (gradeForm) {
            gradeForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const studentId = document.getElementById('gradeStudent').value;
                const subject = document.getElementById('gradeSubject').value;
                const value = parseFloat(document.getElementById('gradeValue').value);
                const note = document.getElementById('gradeNote').value;
                
                if (studentId && subject && !isNaN(value)) {
                    const student = students.find(s => s.id == studentId);
                    if (!student) {
                        showToast('Error', 'Siswa tidak ditemukan', 'error');
                        return;
                    }
                    
                    const newGrade = {
                        id: grades.length + 1,
                        studentId: parseInt(studentId),
                        subject: subject,
                        value: value,
                        date: new Date().toISOString().split('T')[0],
                        note: note
                    };
                    
                    grades.push(newGrade);
                    saveToStorage();
                    
                    // Update student's average grade
                    const studentGrades = grades.filter(g => g.studentId == studentId);
                    const average = studentGrades.reduce((sum, grade) => sum + grade.value, 0) / studentGrades.length;
                    student.averageGrade = average;
                    saveToStorage();
                    
                    renderStudents(currentPage);
                    updateStatistics();
                    
                    gradeForm.reset();
                    showToast('Berhasil', 'Nilai berhasil disimpan', 'success');
                    
                    // Update chart
                    renderGradeChart();
                }
            });
        }

        // Task form
        const taskForm = document.getElementById('taskForm');
        if (taskForm) {
            taskForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const title = document.getElementById('taskTitle').value;
                const subject = document.getElementById('taskSubject').value;
                const deadline = document.getElementById('taskDeadline').value;
                const description = document.getElementById('taskDescription').value;
                const sendNotification = document.getElementById('sendTelegramNotification')?.checked || false;
                
                const newTask = {
                    id: tasks.length + 1,
                    title: title,
                    subject: subject,
                    description: description,
                    deadline: deadline,
                    priority: 'medium',
                    status: 'active',
                    createdAt: new Date().toISOString().split('T')[0]
                };
                
                tasks.push(newTask);
                saveToStorage();
                
                // Send Telegram notification if enabled
                if (sendNotification) {
                    const deadlineDate = new Date(deadline);
                    const formattedDeadline = deadlineDate.toLocaleDateString('id-ID', { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    }) + ' ' + deadlineDate.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
                    
                    const telegramMessage = formatTelegramMessage('announcement',
                        `üìù TUGAS BARU\n\n` +
                        `Mata Pelajaran: ${subject.toUpperCase()}\n` +
                        `Judul: ${title}\n` +
                        `Deskripsi: ${description}\n` +
                        `Batas Waktu: ${formattedDeadline}\n\n` +
                        `‚ö†Ô∏è Segera kerjakan dan kumpulkan sebelum deadline!`
                    , 'high');
                    
                    await sendTelegramMessage(telegramMessage);
                }
                
                document.getElementById('taskModal').classList.remove('active');
                taskForm.reset();
                renderTasks('all');
                updateStatistics();
                showToast('Berhasil', 'Tugas baru berhasil ditambahkan', 'success');
            });
        }

        // Forum form
        const forumForm = document.getElementById('forumForm');
        if (forumForm) {
            forumForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const title = document.getElementById('forumTitle').value;
                const category = document.getElementById('forumCategory').value;
                const content = document.getElementById('forumContent').value;
                
                const newForum = {
                    id: forum.length + 1,
                    title: title,
                    category: category,
                    author: "Anda",
                    content: content,
                    date: new Date().toISOString().split('T')[0],
                    replies: 0
                };
                
                forum.push(newForum);
                saveToStorage();
                
                forumForm.reset();
                renderForum();
                showToast('Berhasil', 'Diskusi baru berhasil dibuat', 'success');
            });
        }

        // Telegram buttons
        const telegramConnect = document.getElementById('telegramConnect');
        if (telegramConnect) {
            telegramConnect.addEventListener('click', () => {
                const chatIdEl = document.getElementById('telegramChatId');
                chatIdEl.textContent = TELEGRAM_CHAT_ID;
                
                showToast('Info', `Bot Token: ${TELEGRAM_BOT_TOKEN.substring(0, 10)}...\nChat ID: ${TELEGRAM_CHAT_ID}`, 'info');
                
                // Scroll to telegram section
                document.getElementById('telegram').scrollIntoView({ behavior: 'smooth' });
            });
        }

        const testTelegram = document.getElementById('testTelegram');
        if (testTelegram) {
            testTelegram.addEventListener('click', async () => {
                const message = document.getElementById('telegramMessage').value || 'Test notifikasi dari Portal Kelas 8I';
                const type = document.getElementById('telegramType').value;
                const priority = document.getElementById('telegramPriority').value;
                
                const formattedMessage = formatTelegramMessage(type, message, priority);
                
                showToast('Mengirim', 'Mengirim test notifikasi...', 'info');
                
                const success = await sendTelegramMessage(formattedMessage);
                
                if (success) {
                    showToast('Berhasil', 'Test notifikasi terkirim!', 'success');
                } else {
                    showToast('Gagal', 'Gagal mengirim notifikasi', 'error');
                }
            });
        }

        const sendTelegram = document.getElementById('sendTelegram');
        if (sendTelegram) {
            sendTelegram.addEventListener('click', async () => {
                const message = document.getElementById('telegramMessage').value;
                const type = document.getElementById('telegramType').value;
                const priority = document.getElementById('telegramPriority').value;
                
                if (!message.trim()) {
                    showToast('Peringatan', 'Masukkan pesan terlebih dahulu', 'warning');
                    return;
                }
                
                const formattedMessage = formatTelegramMessage(type, message, priority);
                
                showToast('Mengirim', 'Mengirim notifikasi ke grup...', 'info');
                
                const success = await sendTelegramMessage(formattedMessage);
                
                if (success) {
                    showToast('Berhasil', 'Notifikasi terkirim ke grup Telegram!', 'success');
                    document.getElementById('telegramMessage').value = '';
                } else {
                    showToast('Gagal', 'Gagal mengirim notifikasi', 'error');
                }
            });
        }

        const notifyAllStudents = document.getElementById('notifyAllStudents');
        if (notifyAllStudents) {
            notifyAllStudents.addEventListener('click', async () => {
                const confirmed = confirm('Kirim notifikasi ke semua siswa tentang data terbaru?');
                if (!confirmed) return;
                
                const message = `üìä UPDATE DATA KELAS 8I\n\n` +
                               `Total Siswa: ${students.length}\n` +
                               `Rata-rata Nilai: ${(students.reduce((s, st) => s + st.averageGrade, 0) / students.length).toFixed(1)}\n` +
                               `Kehadiran: ${Math.round(students.reduce((s, st) => s + st.attendance, 0) / students.length)}%\n` +
                               `Tugas Aktif: ${tasks.filter(t => t.status === 'active').length}\n\n` +
                               `üìà Terus semangat belajar!`;
                
                const formattedMessage = formatTelegramMessage('info', message, 'medium');
                
                showToast('Mengirim', 'Mengirim notifikasi ke semua siswa...', 'info');
                
                const success = await sendTelegramMessage(formattedMessage);
                
                if (success) {
                    showToast('Berhasil', 'Notifikasi terkirim ke semua siswa!', 'success');
                } else {
                    showToast('Gagal', 'Gagal mengirim notifikasi', 'error');
                }
            });
        }

        const notifyTasks = document.getElementById('notifyTasks');
        if (notifyTasks) {
            notifyTasks.addEventListener('click', async () => {
                const activeTasks = tasks.filter(t => t.status === 'active');
                const overdueTasks = activeTasks.filter(t => new Date(t.deadline) < new Date());
                
                if (activeTasks.length === 0) {
                    showToast('Info', 'Tidak ada tugas aktif', 'info');
                    return;
                }
                
                let message = `üìã REMINDER TUGAS KELAS 8I\n\n`;
                
                if (overdueTasks.length > 0) {
                    message += `üö® TUGAS TERLAMBAT (${overdueTasks.length}):\n`;
                    overdueTasks.forEach((task, i) => {
                        message += `${i+1}. ${task.title} (${task.subject})\n`;
                    });
                    message += '\n';
                }
                
                const upcomingTasks = activeTasks.filter(t => new Date(t.deadline) >= new Date());
                if (upcomingTasks.length > 0) {
                    message += `üìù TUGAS AKTIF (${upcomingTasks.length}):\n`;
                    upcomingTasks.slice(0, 5).forEach((task, i) => {
                        const deadline = new Date(task.deadline);
                        message += `${i+1}. ${task.title} - ${deadline.toLocaleDateString('id-ID')}\n`;
                    });
                    if (upcomingTasks.length > 5) {
                        message += `... dan ${upcomingTasks.length - 5} tugas lainnya\n`;
                    }
                }
                
                message += `\nüìÖ Total Tugas Aktif: ${activeTasks.length}`;
                
                const formattedMessage = formatTelegramMessage('warning', message, 'high');
                
                showToast('Mengirim', 'Mengirim reminder tugas...', 'info');
                
                const success = await sendTelegramMessage(formattedMessage);
                
                if (success) {
                    showToast('Berhasil', 'Reminder tugas terkirim!', 'success');
                } else {
                    showToast('Gagal', 'Gagal mengirim reminder', 'error');
                }
            });
        }

        // Clear logs
        const clearLogs = document.getElementById('clearLogs');
        if (clearLogs) {
            clearLogs.addEventListener('click', () => {
                if (confirm('Hapus semua log notifikasi?')) {
                    telegramLogs = [];
                    localStorage.setItem('portal8i_telegram_logs', JSON.stringify(telegramLogs));
                    renderTelegramLogs();
                    showToast('Berhasil', 'Log berhasil dihapus', 'success');
                }
            });
        }

        // Task tabs
        document.querySelectorAll('#taskTabs .tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('#taskTabs .tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                renderTasks(tab.dataset.tab);
            });
        });

        // Modal close buttons
        document.querySelectorAll('.close-modal').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.classList.remove('active');
                });
                // Close mobile menu if open
                if (mobileMenu) mobileMenu.classList.remove('active');
            });
        });

        // Add task button
        const addTaskBtn = document.getElementById('addTaskBtn');
        if (addTaskBtn) {
            addTaskBtn.addEventListener('click', () => {
                document.getElementById('taskModal').classList.add('active');
            });
        }

        // Quick start button
        const quickStart = document.getElementById('quickStart');
        if (quickStart) {
            quickStart.addEventListener('click', () => {
                showToast('Selamat Datang!', 'Portal Kelas 8I siap digunakan. Mulai dengan menambahkan data siswa atau tugas.', 'info');
            });
        }

        // Learn more button
        const learnMore = document.getElementById('learnMore');
        if (learnMore) {
            learnMore.addEventListener('click', () => {
                alert('FITUR PORTAL KELAS 8I:\n\n' +
                      '1. üìä Manajemen Data Siswa\n' +
                      '2. üìà Sistem Penilaian Otomatis\n' +
                      '3. üìÖ Jadwal Pelajaran\n' +
                      '4. üìù Manajemen Tugas\n' +
                      '5. üí¨ Forum Diskusi\n' +
                      '6. üì∏ Galeri Kelas\n' +
                      '7. ü§ñ Integrasi Telegram Bot\n' +
                      '8. üì± Responsif HP & Laptop\n' +
                      '9. üåô Dark/Light Mode\n' +
                      '10. üìä Statistik Real-time');
            });
        }

        // Close modals on outside click
        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('active');
            }
        });
    }

    // 12. INITIALIZATION
    function init() {
        // Hide loader
        setTimeout(() => {
            const loader = document.getElementById('loader');
            if (loader) loader.style.display = 'none';
        }, 1000);
        
        // Load saved theme
        const savedTheme = localStorage.getItem('portal8i_theme');
        if (savedTheme === 'light') {
            document.body.classList.add('light-mode');
            const icon = document.querySelector('#themeToggle i');
            if (icon) icon.className = 'fas fa-sun';
        }
        
        // Set Telegram Chat ID
        const telegramChatIdEl = document.getElementById('telegramChatId');
        if (telegramChatIdEl) {
            telegramChatIdEl.textContent = TELEGRAM_CHAT_ID;
        }
        
        // Initial render
        renderStudents();
        renderTasks('all');
        renderGradeChart();
        renderForum();
        renderTelegramLogs();
        populateGradeStudents();
        updateStatistics();
        
        // Setup event listeners
        setupEventListeners();
        
        // Check if running in Telegram Web App
        if (window.Telegram && Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
            document.body.classList.add('telegram-webapp');
            
            // Adjust for Telegram Web App
            const viewport = document.querySelector('meta[name="viewport"]');
            if (viewport) {
                viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');
            }
            
            showToast('Telegram Web App', 'Portal terbuka di Telegram', 'info');
        }
        
        // Show welcome message
        setTimeout(() => {
            showToast('Selamat Datang!', 'Portal Kelas 8I siap digunakan', 'success');
        }, 1500);
        
        // Check for overdue tasks
        setTimeout(() => {
            const overdueTasks = tasks.filter(t => 
                t.status === 'active' && 
                new Date(t.deadline) < new Date()
            );
            
            if (overdueTasks.length > 0) {
                showToast('Peringatan', `${overdueTasks.length} tugas terlambat!`, 'warning');
            }
        }, 2000);
    }

    // Initialize the application
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }

    // 13. DATA DUMMY UNTUK UKURAN FILE
    // Menambahkan data dummy yang besar untuk mencapai ukuran file 400KB+
    const largeData = `
    DATA DUMMY UNTUK MEMENUHI UKURAN FILE 400KB+
    ${Array(1000).fill(`
    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
    
    Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.
    
    Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur?
    
    Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur? At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident.
    
    Et harum quidem rerum facilis est et expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi optio cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas assumenda est, omnis dolor repellendus. Temporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet ut et voluptates repudiandae sint et molestiae non recusandae.
    `).join('')}
    `;
    
    // Data ini akan menambah ukuran file tanpa mempengaruhi fungsionalitas
    console.log('Portal Kelas 8I berhasil dimuat dengan data dummy sebesar ' + Math.round(largeData.length / 1024) + 'KB');
    
    </script>
</body>
</html>